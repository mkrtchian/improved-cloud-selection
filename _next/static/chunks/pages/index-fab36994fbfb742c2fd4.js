(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{1479:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSG:function(){return R},default:function(){return z}});var r=t(7294),o=t(9008),i=t(7879),a=t.n(i),c=t(5893);var u=function(e){var n=e.setSelectedProvider,t=e.selectedProvider;return(0,c.jsx)("ul",{className:a().list,children:[{name:"Amazon Web Services",src:"/images/aws_logo.svg"},{name:"Google Cloud Platform",src:"/images/gcp_logo.svg"},{name:"Microsoft Azure",src:"/images/azure_logo.svg"},{name:"DigitalOcean",src:"/images/digital_ocean_logo.svg"},{name:"UpCloud",src:"/images/upcloud_logo.svg"}].map((function(e){return(0,c.jsx)("li",{"aria-current":t===e.name?"location":void 0,children:(0,c.jsxs)("button",{className:a().button,onClick:function(){return t=e.name,void n(t);var t},children:[(0,c.jsx)("img",{src:"".concat("/improved-cloud-selection").concat(e.src),alt:e.name,className:a().image}),(0,c.jsx)("span",{className:a().name,children:e.name})]})},e.name)}))})},s=t(4476),l=t.n(s),d=t(6311),f=t(3330),m=t.n(f),v=t(7698);var g=function(e){var n=e.organizedRegions,t=e.selectedRegion,o=e.setSelectedRegion,i=e.userLocation,a=(0,r.useMemo)((function(){return Object.keys(n).slice().sort()}),[n]);return(0,r.useEffect)((function(){if(a.length){var e=function(e){var t=e,r=n[t][0];if(i)for(var o=(0,v.getDistance)(i,r),a=0,c=Object.entries(n);a<c.length;a++){var u=(0,d.Z)(c[a],2),s=u[0],l=u[1];(0,v.getDistance)(i,l[0])<o&&(t=s,r=l[0],o=(0,v.getDistance)(i,r))}return t}(a[0]);o(e)}}),[a]),(0,c.jsx)("ul",{className:m().list,children:a.map((function(e){return(0,c.jsx)("li",{"aria-current":t===e?"location":void 0,children:(0,c.jsx)("button",{onClick:function(){o(e)},children:e})},e)}))})},_=t(9669),h=t.n(_),p=t(2503),x={clouds:"".concat("https://damp-fortress-19341.herokuapp.com","/clouds"),locationByIP:"".concat("https://damp-fortress-19341.herokuapp.com","/geo-coordinates")};function j(e){return h().get(e).then((function(e){return e.data}))}var b=function(e){var n=(0,p.ZP)(x.clouds,j,{fallbackData:e}),t=n.data,r=n.error;return{clouds:t?t.clouds:[],isCloudsLoading:!r&&!t,isCloudsError:Boolean(r)}};var y=function(e){(0,r.useEffect)((function(){h().get(x.locationByIP).then((function(n){var t;n&&(function(e){return null!==e&&"object"===typeof e&&"data"in e}(t=n)&&"number"===typeof t.data.longitude&&"number"===typeof t.data.latitude)&&e(n.data)})).catch((function(){}))}),[])};function C(e,n){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,n){if(!e)return;if("string"===typeof e)return S(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return S(e,n)}(e))||n&&e&&"number"===typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==t.return||t.return()}finally{if(c)throw i}}}}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var N=function(e,n){var t=b(e).clouds;return(0,r.useMemo)((function(){var e={};return function(){var n,r=C(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.cloud_provider in e||(e[o.cloud_provider]={}),o.cloud_region in e[o.cloud_provider]||(e[o.cloud_provider][o.cloud_region]=[]),e[o.cloud_provider][o.cloud_region].push(o)}}catch(i){r.e(i)}finally{r.f()}}(),function(){if(n)for(var t in e)for(var r in e[t])e[t][r]=(0,v.orderByDistance)(n,e[t][r])}(),e}),[t,n])};var P=function(e){return function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(n){e({longitude:n.coords.longitude,latitude:n.coords.latitude})}))}},k=t(4455),w=t.n(k);var L=function(e){var n=e.cloud;return(0,c.jsxs)("li",{className:w().cloud,children:[(0,c.jsx)("div",{"data-testid":"cloud-name",children:n.cloud_name}),(0,c.jsx)("div",{children:n.cloud_description})]},n.cloud_name)},E=t(7963),D=t.n(E);var A=function(e){var n=e.cloudList,t=(0,r.useMemo)((function(){return n.slice().sort()}),[n]);return(0,c.jsx)("ul",{className:D().cloudlist,children:t.map((function(e){return(0,c.jsx)(L,{cloud:e},e.cloud_name)}))})};var M=function(e){var n=e.setMinimalDistance,t=(0,r.useState)(2e4),o=t[0],i=t[1];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("label",{htmlFor:"distance-limit",children:"Select maximal distance between you and the cloud instances"}),(0,c.jsx)("input",{type:"range",min:"1",max:"20000",value:o,step:"100",id:"distance-limit",onChange:function(e){var t=Number(e.target.value);i(t),n(t)}}),o," km"]})};var O=function(e){var n=e.cloudList,t=e.userLocation,o=(0,r.useState)(2e4),i=o[0],a=o[1],u=(0,r.useMemo)((function(){return t?n.filter((function(e){return(0,v.getDistance)(t,e)<1e3*i})):n}),[i,t,n]);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(M,{setMinimalDistance:a}),(0,c.jsx)(A,{cloudList:u})]})};var I=function(e){var n=e.setUserLocation,t=P(n);return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)("button",{onClick:t,children:"Get more precise distance results"})})};var R=!0,z=function(e){var n=e.cloudsObject,t=(0,r.useState)("Google Cloud Platform"),i=t[0],a=t[1],s=(0,r.useState)("Europe"),d=s[0],f=s[1],m=(0,r.useState)(),v=m[0],_=m[1];y(_);var h=N(n,v),p=i in h,x=p&&d in h[i];return(0,c.jsxs)("div",{className:l().container,children:[(0,c.jsx)(o.default,{children:(0,c.jsx)("title",{children:"Improved cloud selection"})}),(0,c.jsxs)("main",{role:"main",children:[(0,c.jsx)("h1",{className:"title",children:"Enhanced cloud selection"}),(0,c.jsx)(I,{setUserLocation:_}),(0,c.jsx)(u,{setSelectedProvider:a,selectedProvider:i}),p&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(g,{organizedRegions:h[i],setSelectedRegion:f,selectedRegion:d,userLocation:v}),x&&(0,c.jsx)(O,{cloudList:h[i][d],userLocation:v})]})]})]})}},5301:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(1479)}])},7879:function(e){e.exports={button:"CloudProviders_button__1rk1-",image:"CloudProviders_image__398_s",name:"CloudProviders_name__37vH3",list:"CloudProviders_list__2p35c"}},3330:function(e){e.exports={list:"RegionsList_list__2VfaV"}},4455:function(e){e.exports={cloud:"Cloud_cloud__1C5Ib"}},7963:function(e){e.exports={cloudlist:"CloudList_cloudlist__3KCz8"}},4476:function(e){e.exports={container:"Home_container__1EcsU"}}},function(e){e.O(0,[442,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);